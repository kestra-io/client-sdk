# Agent Guide: Go SDK Test Development

## Core Rules

1. **After every important change:** `go test -c ./...`
2. **Before finishing:** `go test ./...`
3. **Only commit if:** Tests pass AND explicitly requested
4. **Never push** (commits only)

## Workflow

### Development
```
Change → go test -c ./...
  ├─ Errors? → Fix → Retry
  └─ OK? → Continue
```

### Before Finishing
```
go test ./...
  ├─ Failures? → Fix → Retry
  └─ Pass? → Continue
```

### If Commit Requested
```
git add .
git commit -m "message"
# STOP - do NOT push
```

## Quick Commands

| Task | Command                            |
|------|------------------------------------|
| Check syntax | `go test -c ./...`                 |
| Run all tests | `go test ./...`                    |
| Run single test | `go test ./... -run TestName -v`   |
| Commit | `git add . && git commit -m "msg"` |

## ✅ DO

- Run `go test -c ./...` after changes
- Run `go test ./...` before finishing
- Fix errors immediately
- Use clear commit messages
- Commit only if tests pass
- Commit only if explicitly requested

## ❌ DON'T

- Skip syntax checks
- Proceed with errors
- Commit failing tests
- Commit without request
- Push changes
- Accumulate errors

## Error Handling

| Issue | Action |
|-------|--------|
| Compilation error | Read message, fix line, retry |
| Test failure | Debug logic, fix, retry |
| Connection error | Check if Kestra running |
| Timeout | Check resource limits |

## File Reference

| File | Purpose |
|------|---------|
| `go-sdk/test/api_flows_test.go` | Main tests |
| `go-sdk/test/common_test_setup.go` | Helpers |
| `go-sdk/test/api_executions_test.go` | Reference |
| `java/.../FlowsApiTest.java` | Java reference |

## Test Patterns

### Basic Test
```go
t.Run("testName", func(t *testing.T) {
    namespace := randomId()
    flowId := randomId()
    ctx := GetAuthContext()
    createSimpleFlow(ctx, flowId, namespace)

    result, _, err := KestraTestApiClient().FlowsAPI.Method(ctx, ...).Execute()
    require.NoError(t, err)
})
```

## Helpers Available

- `KestraTestApiClient()` - API client
- `GetAuthContext()` - Auth context
- `randomId()` - Random ID
- `createSimpleFlow(ctx, id, ns)` - Create flow
- `LOG_FLOW(id, ns)` - Flow template

## Decision Tree

```
Made changes?
├─ YES → go test -c ./...
│   ├─ Errors? → Fix → Retry
│   └─ OK → Continue
└─ NO → Skip

Done with changes?
├─ NO → Continue
└─ YES → go test ./...
    ├─ Failures? → Fix → Retry
    └─ Pass → Check if commit requested
        ├─ NO → Done
        └─ YES → git add . && git commit -m "msg"
```

## Summary Checklist

**Before Starting**
- [ ] Read this guide
- [ ] Understand task
- [ ] Know which files to edit

**During Development**
- [ ] Make small changes
- [ ] After each: `go test -c ./...`
- [ ] Fix errors immediately
- [ ] Follow existing patterns

**Before Finishing**
- [ ] All changes done
- [ ] Run `go test ./...`
- [ ] All tests pass
- [ ] No regressions

**For Commit**
- [ ] Tests pass
- [ ] Commit requested
- [ ] `git add . && git commit -m "message"`
- [ ] Do NOT push

---


**Updated:** January 21, 2026

